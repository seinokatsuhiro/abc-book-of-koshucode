# P. 関係の集合


## 空関係

この節では、まず、空のデータを調べまてみましょう。
空ではないデータから始めて、それを空のデータに変換します。

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ { .koshu .input }
|-- ROP-INDEX  /file "P.k"  /rop 'cut
|-- ROP-INDEX  /file "P.k"  /rop 'keep
|-- ROP-INDEX  /file "P.k"  /rop 'dee
|-- ROP-INDEX  /file "P.k"  /rop 'dum
|-- ROP-INDEX  /file "P.k"  /rop 'source
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

この判断集合を、つぎの式で関係として読み出します。

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ { .koshu .input }
index : source ROP-INDEX /file /rop
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

この関係を項目 `/rop` の内容で制限します。

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ { .koshu .input }
index-cut    : index | keep /rop = 'cut
index-delete : index | keep /rop = 'delete
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

関係 `index-cut` はひとつの組をもち、
関係 `index-delete` は組をもちません。
組のない関係は **空関係** とよばれます。
理解を助けるために、これらの関係を図示すると、
`index-cut` は左のように、`index-delete` は右のように書けます。

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ { .koshu }
[ /file | /rop ]    [ /file | /rop ]    関係の見出し (項目)
----------------    ----------------
[ "P.k" | 'cut ]                        関係の本体 (組の集合)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

この図の 1 行目のような関係の項目を **見出し** 、
3 行目以降の組の集合を **本体** とよびます。
2 行目は見出しと本体との区切りを示す水平線です。
空関係であっても一定の項目からなる見出しをもっています。


## 万有関係

空関係は、組をもたない関係であることをみました。
逆に、考えうるすべての組をもつ関係は **万有関係** よばれます。
万有関係は、項目内容を適当な種類に制限しない限り、
書ききれないため、数をどこまでも数えていくような感覚で、
頭のなかで想像してみてください。
無限に長いモノサシを想像すると、
ちょうど、どのような実数も、そのモノサシのどこかに対応するように、
どのような関係も、空関係から万有関係までの系列のなかの
どこかに位置します。


## 無項関係

関係 `index-cut` と `index-delete` から項目
`/file` と `/rop` を取り除き、項目のない関係に変換します。

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ { .koshu .input }
some-cut    : index-cut    | cut /file /rop
some-delete : index-delete | cut /file /rop
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

このように定式化された関係 `some-cut` と `some-delete` は、
上の図から `[` と `]` に囲まれた部分を取り除いたような図として書けます。

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ { .koshu }
[  ]        [  ]
----        ----
[  ]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

これらは、項目をもたない関係という意味で **無項関係** とよばれます。
無項の組はひとつしかないので、
無項関係は、その組を含むか含まないかの 2 種類しかないことになります。

- 左の関係は、無項関係として可能なすべての組をもっているので、
  **無項万有関係** とよばれます。

- 右の関係は、無項関係で、同時に、空関係なので、
  **無項空関係** とよばれます。

これらの関係を、つぎの式により判断集合に変換すると、

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ { .koshu .input }
|== SOME-CUT    : some-cut
|== SOME-DELETE : some-delete
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

判断種 `SOME-CUT` の判断だけが、項目なしで出力されます。

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ { .koshu .output }
|-- SOME-CUT
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

逆に、このような判断を `source SOME-CUT` と
`source SOME-DELETE` により読み出せば、上の関係が得られます。
これらの判断種に対応するデータ解釈は、つぎのように書けるでしょう。

 - `SOME-CUT` : 演算子 `'cut` を使用しているファイルがある。

 - `SOME-DELETE` : 演算子 `'delete` を使用しているファイルがある。

このデータ解釈は、可変の要素としての項目を含んでおらず、
それ自身で真偽が確定します。
`SOME-DELETE` は無条件にそれがみたされないので、
判断がひとつもないことになります。


## 全項関係

甲州記法には、無項空関係を出力する演算子 `dum` と
無項万有関係を出力する `dee` が事前に定義されています。
`dum` と `dee` の名称は、関係モデルの文献のなかでは
tabledum と tabledee ともよばれ、
イギリスの童謡のなかに登場する [トゥイードルダムとトゥイードルディー][dumdee]
に由来します。

無項万有関係 `dee` を定式化する興味深い方法があります。
それは、考えうるすべての関係の結び `join` を計算するという方法です。
たとえば、つぎのような関係 `a` と `b` は共有項目をもたないため、
`c` は `dee` と同じ関係になります。

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ { .koshu .input }
|-- A  /a 1
|-- B  /b 1

a : source A /a
b : source B /b
c : a | join b
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

どのような関係も `dee` との結びは、ふたたび、`dee` になることから、
すべての関係の結びを計算すると `dee` になることがわかります。

いま、すべての関係の結びを考えたので、
逆に、すべての関係の交わりはどのようになるでしょうか。
`d : a | meet b` は項目 `/a` `/b` をもっており、
さらに、ほかの関係との交わりをつくっていけば、項目の種類が増えていきます。
空関係との交わりは、つねに、空関係になるので、
最終的には、すべての項目をもつ空関係、
つまり、 **全項空関係** になります。
全項空関係もまた、万有関係のように、項目の種類を適当に限定しないかぎり、
すべてを書きあらわすことはできません。


## 4 つの極

これまでに、(1) 無項関係、(2) 全項関係、
(3) 空関係、(4) 万有関係 という関係の分類をみてきました。
これらを組み合わせると 4 つの極となる関係があることがわかります。

| | **無項関係** | **全項関係** |
|---|---|---|
| **空関係** | 無項空関係 (dum) | 全項空関係 (dau) |
| **万有関係** | 無項万有関係 (dee) | 全項万有関係 (daa) |

甲州記法の現実的な応用のなかで、
これらの関係に出会うことはないかもしれませんが、
考えうるすべての関係の集合のなかに、このような 4 つの極があり、
したがって、どのような関係も、これらの極の間のどこかに位置し、
無項万有関係 (dee) が結び `join` の極限で、
全項空関係 (dau) が交わり `meet` の極限であることを憶えておきましょう。


[P.k]:    ../P/P.k
[dumdee]: http://ja.wikipedia.org/wiki/トゥイードルダムとトゥイードルディー

